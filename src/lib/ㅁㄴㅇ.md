# 포함 기획서: 미니 민명 게임

## 플레이 가이드

### 가까운 설정
- 게임 구조: 5가지 트리(군사/방어/경제/기술/외그)
- 터널: 50턴 / 100턴 / 200턴 구현
- 시대: 중세 → 관대 → 현대
- 트리별 기술 개수: 적어도 10개 이상 포함
- 처음 트리 선택: 필요(게임 첫 턴에 선택)

---

## 부트리 전환 뢰(Branch Switching Rule)

### 1. 기본 규칙
- 처음에는 1가지 메인트리(Main Tree)만 선택 가능.

### 2. 부트리 전환 조건
- **30턴 건강**후
- **메인트리 기술 5개 여개 건강**후
- 부트리 연구에는 규천적으로 **연구 평균 포인트 20%의 추가 소모** 필요.

### 3. 부트리 선택 방식
- UI에서 마우스로 드림 및 트리 개발 목록 표시.
- 다른 트리의 첫 기술 연구 가능.
- 부트리의 계속 연구가 가능(해당 트리 내 순차적 연결).

### 4. 부트리 한정
- 모든 게임에서 하나의 부트리만 개발가 가능.

---

## 연구 순서 결정 시스템 (Flexible Tech Path)

### 1. 자유 연구 시스템
- 같은 트리 내에서는 자유로 연구 순서 결정 가능.
- 선행 구조(Prerequisite)를 가지고 계층적으로 가야 한다.

### 2. 연구 가능 기술 표시
- 연구 가능한 기술: 빛이 밝은 것으로 표시
- 연구 불가능 기술: 화이트가 바라진 형태 표시

### 3. 연구 계획(Queue) 기능
- 이미 연구할 기술을 두장~세개 무기 지정가능.
- 조건 충출시 자동으로 연구 시작.

### 4. 선행 관계 표시
- UI에서 선행 관계를 표시 (파란색 화이에 헤고 당겨 선택 가능)
- 화이를 클릭시 "이 기술은 다음의 선행 가요" 타겟 표시

---

## 추가 기획(복습)
- 부트리 전환시 결정 이벤트(목표, 구역) 표시
- 부트리 가여에 성공시 조금의 게임 보상(고등지, 해킹사 회복, 광고)

---

이 기획을 기본으로 하면 미니민명 게임의 구조가 특화관계적으로 가능 한 것으로 구조할 수 있습니다.

## 데이터베이스 스키마

### 1. Technology 테이블
- **id**: INT, PK, AUTO_INCREMENT
- **name**: VARCHAR(100), 기술명
- **description**: TEXT, 기술 설명
- **era**: ENUM('medieval','industrial','modern'), 시대 구분
- **tree_type**: ENUM('military','defense','economic','science','diplomacy'), 트리 종류
- **research_cost**: INT, 기본 연구 비용
- **research_time_modifier**: FLOAT, 부트리 전환 시 비용 배율 등 추가 modifier

### 2. Prerequisite 테이블
- **id**: INT, PK, AUTO_INCREMENT
- **tech_id**: INT, FK → Technology(id)
- **prereq_id**: INT, FK → Technology(id)
- (각 기술의 선행 기술 관계를 1:N으로 관리)

### 3. PlayerTechnology 테이블
- **id**: INT, PK, AUTO_INCREMENT
- **player_id**: INT, FK → Player(id)
- **tech_id**: INT, FK → Technology(id)
- **status**: ENUM('locked','available','in_progress','completed')
- **progress_points**: INT, 현재 축적된 연구 포인트
- **started_at**: DATETIME, 연구 시작 시각
- **completed_at**: DATETIME, 연구 완료 시각

### 4. TreeSelection 테이블
- **id**: INT, PK, AUTO_INCREMENT
- **player_id**: INT, FK → Player(id)
- **tree_type**: ENUM('military','defense','economic','science','diplomacy')
- **is_main**: BOOLEAN, 메인트리 여부
- **selected_at**: DATETIME

### 5. ResearchQueue 테이블
- **id**: INT, PK, AUTO_INCREMENT
- **player_id**: INT, FK → Player(id)
- **tech_id**: INT, FK → Technology(id)
- **queue_position**: INT, 순서
- **added_at**: DATETIME

---

이 구조를 사용하면:
1. **Technology**와 **Prerequisite**로 트리 구조를 정의
2. **PlayerTechnology**로 각 플레이어의 연구 상태 관리
3. **TreeSelection**으로 메인/부트리 선택 기록
4. **ResearchQueue**로 연구 예약 기능 지원

위 테이블을 기반으로 비즈니스 로직을 구현하면 빠르고 유연한 연구 시스템을 운영할 수 있습니다.

---

## 건물 생산 설계 (Building Production)

### 1. 건물 종류 & 분류
- **주거(Housing):** 시민 수용, 인구 성장량 증가 (예: 주택, 아파트)
- **생산(Production):** 생산력 보너스 (예: 작업장, 대장간)
- **과학(Science):** 연구 속도 보너스 (예: 도서관, 대학)
- **문화(Culture):** 문화 점수 획득 (예: 극장, 박물관)
- **방어(Defense):** 도시 방어력 증가 (예: 성벽, 포탑)
- **무역(Trade):** 골드 수익 및 무역로 개방 (예: 시장, 항구)

### 2. 건설 인프라
- **건설자(Builder):** 각 도시별 건설자 수량 제한 (레벨에 따라 증가)
- **자원(Resource):** 목재, 석재, 철 등 건설 자원 소모

### 3. 건설 메커니즘
1. **건설점수(Build Points):** 도시별 매 턴 확보되는 건설력 사용
2. **건설 시작:** 도시 UI에서 건설 가능한 건물 목록 표시 → 건물 선택 → 건설 시작
3. **건설 시간:** 건물별 고정 턴 소요 (예: 주택 3턴, 대학 6턴)
4. **건설 큐:** 한 도시당 최대 2개까지 건설 예약 가능
5. **건설 중단/취소:** 진행 중인 건설은 중단 가능, 일부 자원은 회수

### 4. 유지비 & 보급
- **유지비(Maintenance):** 매 턴 골드 및 자원 소모 (건물 유형별 차등)
- **보급 범위(Supply Range):** 특별 시설(예: 포탑)은 특정 거리 내 유닛/도시만 혜택

### 5. 선행 조건 & 언락
- **기술 연동:** 기술 트리에서 해당 건물 연구 후 건설 가능
  - 예: `대학교 설립` 연구 완료 → 대학 건설 가능
  - `성곽 건설` 연구 완료 → 성벽 건설 가능

### 6. UI 구성 요소
- **도시 건설 패널:** 보유 건설력, 큐 상태, 유지비 합산
- **건물 리스트 뷰:** 잠금/사용 가능 상태, 건설 턴, 자원 비용 표시
- **진행 바:** 남은 턴 시각화
- **큐 관리 버튼:** Up/Down으로 순서 변경, 취소 기능

### 7. 밸런스 & 한계
- **도시별 건설 한계:** 도시 레벨(인구 기준)별 최대 건설 슬롯 수 제한
- **건물 중복 제한:** 특정 건물은 도시당 한 개만 건설 가능
- **자원 조달 밸런스:** 자원 획득과 소비 간의 전략적 조율 필요

### 8. 데이터베이스 스키마 (추가)
- **Building** 테이블: id, name, category, description, build_time, resource_cost (JSON), maintenance_cost (JSON), prerequisite_tech_id
- **PlayerBuilding** 테이블: id, player_id, city_id, building_id, status, started_at, completed_at
- **BuildQueue** 테이블: id, player_id, city_id, building_id, queue_position, added_at


건물 생산 섹션을 추가했어! 이제 기획서에서 건물 시스템까지 완벽하게 다루게 되었어. 필요하면 ERD나 DDL 예시도 요청해줘!

---

## 유닛 생산 설계 (Unit Production)

### 1. 유닛 타입 & 분류
- **근접(Melee):** 보병, 창병
- **기병(Cavalry):** 기마병, 기사
- **원거리(Ranged):** 궁수, 머스킷병
- **공성(Siege):** 대포, 공성 무기
- **현대 모듈(Modern):** 탱크, 전투기

### 2. 생산 건물 및 인프라
- **병영(Barracks):** 근접·원거리 초기 유닛 생산
- **마굿간(Stables):** 기병 생산
- **공장(Factory):** 근대·현대 기계 유닛 생산
- **비행장(Airfield):** 항공 유닛 생산

### 3. 생산 메커니즘
1. **생산점수(Production Points):** 도시별 매 턴 확보되는 생산력으로 유닛 생성
2. **선택 & 시작:** 도시 UI에서 생산 가능한 유닛 목록 표시 → 유닛 선택 → 생산 시작
3. **생산 시간:** 각 유닛마다 고정 턴 수 소모 (예: 창병 3턴, 탱크 8턴)
4. **생산 큐:** 한 도시당 최대 3개까지 생산 예약 가능
5. **생산 중단/취소:** 진행 중인 생산은 언제든 취소 가능, 일부 자원은 회수

### 4. 유지비 & 보급
- **유지비(Maintenance):** 매 턴 골드 소모 (유닛별 유지비 차등 적용)
- **보급 범위(Supply Range):** 수도에서 일정 거리 이내 유닛만 유지비 절반 적용

### 5. 선행 조건 & 언락
- **기술 연동:** 기술 트리에서 해당 유닛 연구 후 생산 가능
  - 예: `창병술` 연구 완료 → 창병 생산
  - `탱크 개발` 연구 완료 → 탱크 생산

### 6. UI 구성 요소
- **도시 생산 패널:** 보유 생산력, 큐 상태, 유지비 합산
- **유닛 리스트 뷰:** 잠금/사용 가능 상태, 생산 턴, 비용 표시
- **진행 바:** 남은 턴 시각화
- **큐 관리 버튼:** Up/Down으로 순서 변경, 취소 기능

### 7. 밸런스 & 한계
- **도시별 생산 한계:** 레벨별 생산력 상한 설정
- **유닛 상한(유닛 캡):** 전체 보유 유닛 최대치로 전략적 조절
- **전투력 대비 유지비 밸런스:** 방어 vs 공세 간 인센티브 제공

---

유닛 생산 파트를 위 설계에 따라 구현하면,
- 플레이어가 **전략적 생산 우선순위**를 고민
- **기술 연구 결과**가 직접적인 전투력 상승으로 연결
- **유연한 생산 큐**로 전투/방어/탐사 등 다양한 전략 가능

다음으로, 이 설계를 뒷받침할 **데이터베이스 스키마**가 필요하다면 알려줘!
빠르고 유연한 연구 시스템을 운영할 수 있습니다.
